<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="The voting page for my website.">
  <meta name="keywords" content="travel, dream, destination">
  <meta name="author" content="Jessica Leal-Correia">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Stylesheet -->
  <link rel="stylesheet" href="/styles/vote.css">

  <!-- Adding the icon again so everything is cohesive -->
  <link rel="shortcut icon" href="/html/favicon.ico">

  <!-- Title! -->
  <title>Dream Destinations</title>
</head>

<body>
  <!-- It's up to you now. Please vote for the country I should go to. -->
  <div class="header">
    <h1> HELP ME CHOOSE! </h1>
  </div>
  <div class="text">
  <p> Choose wisely. My fate is in your hands...</p>
</div>
  <div id="choices">
  <div class="choice">
    <div class="result">
      <div class="bar" data-choice="1"></div>
    </div>

    <!-- Should I go to Australia? -->
    <div class="label">
      <p>Australia</p>
      <button data-choice="1">Vote</button>
    </div>
  </div>
  <div class="choice">
    <div class="result">
      <div class="bar" data-choice="2"></div>
    </div>

    <!-- Should I go to Japan? -->
    <div class="label">
      <p>Japan</p>
      <button data-choice="2">Vote</button>
    </div>
  </div>
  <div class="choice">
    <div class="result">
      <div class="bar" data-choice="3"></div>
    </div>

    <!-- Should I go to Croatia? -->
    <div class="label">
      <p>Croatia</p>
      <button data-choice="3">Vote</button>
    </div>
  </div>
</div>

<!-- This is my JS section. I've inserted a voting poll for you all to choose where I should go! CHOOSE WISELY. My fate is in your hands.-->
<script type="text/javascript">
var buttons = document.querySelectorAll(".choice button"),
  tally = {
    1: 0,
    2: 0,
    3: 0,
    total: 0
  };

function vote(choice) {
  tally[choice]++;
  tally["total"]++;
  console.log(tally);
}

function barPercentage(node, tally) {
  var choice = node.dataset.choice;
  
  if (tally[choice])
    return tally[choice]/tally["total"] * 100;
  return 0;
}

function renderBars() {
  var bars = document.getElementsByClassName("bar");
  
  for (var i = 0; i < bars.length; i++) {
    var percentage = barPercentage(bars[i], tally);
    console.log(percentage)
    bars[i].style.height = percentage.toString() + "%";
  }
}

function setup() {
  // Set up event listeners
  for (var i = 0; i < buttons.length; i++) {
    buttons[i].addEventListener("click", function(e) {
      vote(e.target.dataset["choice"]);
      renderBars();
    });
  }
  
  renderBars();
}

setup();
</script>
</body>
</html>